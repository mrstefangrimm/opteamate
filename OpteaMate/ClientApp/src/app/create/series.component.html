<!-- Copyright (c) 2020 Stefan Grimm. All rights reserved.
     Licensed under the GPL. See LICENSE file in the project root for full license information.
-->

<table>
  <thead>
    <tr>
      <td width="100%">
        <h1>Opteamate</h1>
      </td>
      <td align="right" valign="top">
        <button mat-raised-button color="standard" (click)="copyLinkToClipboard()">URL in die Zwischenablage</button>
      </td>
    </tr>
    <tr>
      <td width="100%">
        <a [routerLink]="['/']">zur Startseite</a>
      </td>
      <td></td>
    </tr>
  </thead>
</table>

<div *ngIf="!events || !events.length">
  <hr />
  <b><i>Die Serie ist noch leer</i></b>
</div>
<div *ngIf="events && events.length">

  <hr />

  <h2>&Uuml;bersicht</h2>

  <table width="80%">
    <thead>
      <tr>
        <th width="20%" align="left">Wann</th>
        <th width="20%" align="left">Was</th>
        <th width="20%" align="left">Wo</th>
        <th width="10%" align="left">Teilnehmer</th>
        <th width="10%" align="left">Anz. Teilnehmer</th>
        <th width="10%" align="left">Nimmt wer was mit?</th>
        <th width="10%" align="left"></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ev of events">
        <td>{{getLocaleDt(ev.data.start) | date :'dd.MM.yyyy H:mm'}}</td>
        <td>{{ev.data.title}}</td>
        <td>{{ev.data.location}}</td>
        <td *ngIf="ev.registrations.hrefs.hasOwnProperty('post')">
          <a [routerLink]="getLink(ev.data.eventToken)">Registrieren...</a>
        </td>
        <td *ngIf="!ev.registrations.hrefs.hasOwnProperty('post')"> <a [routerLink]="getLink(ev.data.eventToken)">Teilnahmen...</a></td>
        <td>{{ev.data.registrationsCount}}</td>
        <td *ngIf="ev.data.hasSponsors">Ja</td>
        <td *ngIf="!ev.data.hasSponsors">Nein</td>
        <td>
          <button *ngIf="ev.hrefs.hasOwnProperty('delete')" mat-raised-button color="standard" (click)="deleteEvent(ev.id)">L&ouml;schen</button>
        </td>
      </tr>
    </tbody>
  </table>

</div>

<hr />

<form *ngIf="postPermission">

  <h2>Anlass Hinzuf&uuml;gen</h2>

  <div *ngIf="selectedOptimum">
    <mat-form-field>
      <mat-label>Typ</mat-label>
      <mat-select [(value)]="selectedOptimum">
        <mat-option *ngFor="let o of optima" [value]="o">{{o.data.name}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <blockquote *ngIf="selectedOptimum">
    <mat-label>Positionen: {{selectedOptimum.data.positions}}</mat-label><br />
    <mat-label>Optima: {{selectedOptimum.data.strategies}}</mat-label>
  </blockquote>

  <div>
    <mat-form-field class="example-full-width">
      <mat-label>Was</mat-label>
      <input matInput
             name="title"
             id="title"
             [(ngModel)]="newEvent.title"
             type="text"
             class="form-control"
             required />
      <mat-error>Anlass, mindestens 1 Zeichen</mat-error>
    </mat-form-field>
    <mat-form-field class="example-full-width">
      <mat-label>Wo</mat-label>
      <input matInput
             name="location"
             id="location"
             [(ngModel)]="newEvent.location"
             type="text"
             class="form-control"
             required />
      <mat-error>Ort, mindestens 1 Zeichen</mat-error>
    </mat-form-field>
  </div>

  <div>
    <mat-form-field [style.width.px]=120>
      <mat-label>Wann</mat-label>
      <input matInput
             readonly
             name="start"
             [matDatepicker]="picker"
             [(ngModel)]="selectedDate">
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>

    <mat-form-field [style.width.px]=100>
      <mat-label>Uhrzeit</mat-label>
      <mat-select [(value)]="selectedHour">
        <mat-option *ngFor="let h of [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]" [value]="h">{{h.toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false})}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field [style.width.px]=60>
      <mat-select [(value)]="selectedMinutes">
        <mat-option *ngFor="let m of [0, 15, 30, 45]" [value]="m">{{m.toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false})}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-error *ngIf="selectedDate != null && !isFutureDate()">Datum/Uhrzeit m&uuml;ssen mindestens 1 Stunde in der Zukunft liegen.</mat-error>
  </div>

  <button type="reset"
          [disabled]="newEvent.title == null || newEvent.location == null || !isFutureDate()"
          mat-raised-button
          color="primary"
          (click)="addEvent()">
    Hinzuf&uuml;gen
  </button>

</form>

<hr />

<p *ngIf="!postPermission">
  Zur Zeit k&ouml;nnen keine Anl&auml;sse erstellt werden.
</p>

<section *ngIf="postPermission && (!events || events.length == 0)">
  <p>Der wohl schnellste und einfachste Team-Planer der Welt! Der Algorithmus schaut, dass du die richtigen Leute dabei hast.</p>

  <p><u>So geht&acute;s</u></p>
  <ol>
    <li>Erstelle eine Serie von Anl&auml;ssen</li>
    <li>Verschicke die URL per E-Mail oder in einer Messenger App</li>
    <li>Die Leute registrieren sich f&uuml;r die einzelnen Anl&auml;sse. Du hast den &Uuml;berblick.</li>
  </ol>

  <p><u>Was musst du wissen?</u></p>
  <blockquote>In der oberen, rechten Ecke hat es einen Knopf &acute;<i>URL in die Zwischenablage</i>&acute;. <b>Wichtig:</b> Die hinterlegte URL darfst du nicht verlieren.</blockquote>

  <p><u>Warum Opteamate?</u></p>
  <ul>
    <li>Keine Anmeldung n&ouml;tig</li>
    <li>Keine pers&ouml;nlichen Daten wie E-Mail Adresse oder Telefonnummer werden gespeichert</li>
    <li>Keine Cookies und Trackers</li>
    <li>Einmalige Funktionalit&auml;t</li>
  </ul>

  <p><u>Wer steckt hinter Opteamate?</u></p>
  <blockquote>Eine Einzelperson. Ich habe das Projekt als „Warm-Up“ gestartet, um mich mit Webtechnologien vertraut zu machen.</blockquote>
  <blockquote>Der Programmcode ist Open Source und auf <a href="https://github.com/mrstefangrimm/opteamate">Github</a>.</blockquote>

</section>
